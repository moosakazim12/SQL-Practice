
# Question (SELF JOIN)
# How can you output a list of all members who have recommended another member? Ensure that there are no duplicates in the list, and that results are ordered by (surname, firstname).

SELECT DISTINCT
       m.firstname,
       m.surname
FROM cd.members m
INNER JOIN cd.members r
  ON m.memid = r.recommendedby
ORDER BY m.surname, m.firstname;


print("Query executed successfully.")


# Question
# How can you produce a list of the start times for bookings by members named 'David Farrell'?
# I have taken tables and question from https://pgexercises.com/questions/joins/simplejoin.html

SELECT starttime
FROM cd.members AS m
INNER JOIN cd.bookings AS b
USING(memid)
WHERE m.firstname = 'David' AND m.surname = 'Farrell'


# Question
# How can you output a list of all members, including the individual who recommended them (if any)? Ensure that results are ordered by (surname, firstname).
SELECT m1.firstname AS memfname, m1.surname AS memsname,
m2.firstname AS recfname, m2.surname AS recsname
FROM cd.members AS m1
LEFT JOIN cd.members AS m2
 ON m2.memid = m1.recommendedby
ORDER BY memsname,memfname